<!doctype html>
<!--[if lt ie 7]>      <html class="lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if ie 7]>         <html class="lt-ie9 lt-ie8 ie7"> <![endif]-->
<!--[if ie 8]>         <html class="lt-ie9 ie8"> <![endif]-->
<!--[if gt ie 8]><!-->
<html class=""><!--<![endif]-->
<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>i2sec 기술 블로그 | IoT 근거리 통신 Z-wave 해킹-1</title>
  <meta name="description" content="Z-wave란? Z-wave Overview">
  <link rel="canonical" href="https://i2sec.github.io/2017/04/05/z_wave_exploit-1.html">

  <!-- OpenGraph meta tags -->
  <meta property="og:title" content="IoT 근거리 통신 Z-wave 해킹-1">
  <meta property="og:url" content="https://i2sec.github.io/2017/04/05/z_wave_exploit-1.html">
  <meta property="og:site_name" content="i2sec 기술 블로그">
  <meta property="og:description" content="Z-wave란? Z-wave Overview">
  
    <meta property="og:type" content="article">
  
  
    <meta property="og:image" content="https://i2sec.github.io/images/og-logo.png">
  

  <!-- Twitter card meta tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@spoqa">
  <meta name="twitter:title" content="IoT 근거리 통신 Z-wave 해킹-1">
  <meta name="twitter:description" content="Z-wave란? Z-wave Overview">
  
    <meta name="twitter:image" content="https://i2sec.github.io/images/twitter-card.png">
  

  <script>
    window.WebFontConfig = {
        custom: {
            families: ['Spoqa Han Sans:100,300,400,700'],
            urls: ['https://spoqa.github.io/spoqa-han-sans/css/SpoqaHanSans-kr.css']
        },
        timeout: 60000
    };
    (function(d) {
        var wf = d.createElement('script'), s = d.scripts[0];
        wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js';
        s.parentNode.insertBefore(wf, s);
    })(document);
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-36136046-5', 'auto');
    ga('send', 'pageview');
  </script>
  <link rel="stylesheet" href="/css/styles.css">
  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="i2sec 기술 블로그">
  <link rel="shortcut icon" href="/images/favicon.ico">
  <style type="text/css">
    @media only screen and (max-width: 580px) {
      .btn-job {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="header">
      <div class="header-item">
        <div class="spoqa-logo-wrap">
          <a class="spoqa-logo" href="/"><img src="/images/logo.png" alt="i2sec logo"></a>
          <a class="blog-title" href="/">기술 블로그</a>
        </div>
        <div class="nav">
          <input type="checkbox" id="toggle">
          <label for="toggle" class="toggle" onclick></label>
          <ul class="menu">
            <li><a class="
               menu-about" href="/about.html">소개</a></li>
            <li><a class="
              
              selected
               menu-blog" href="/index.html">블로그</a></li>
            <li><a class="menu-github" href="https://github.com/i2sec">GitHub</a></li>
            
            <li><a class="
               menu-job" href="/jobs.html">채용정보</a></li>
            
          </ul>
        </div>
      </div>
    </div>
    <!--<div class="hiring-banner">
      <div class="hiring-fixedwidth-wrap">
        <div class="hiring-content">
          <h2 class="hiring-title">당신과 함께<br> 일하고 싶습니다.</h2>
          <div class="hiring-subtitle">스포카에서 배우고 성장하면서, <br>서비스와 제품을 함께 만들어 나갈 <br>크리에이터를 모집합니다.</div>
          <a class="btn-job" type="button" href="/jobs.html">채용 공고 보기</a>
        </div>
      </div>
    </div>-->
    <div class="content">
      


<div class="post-author-info">
  
    <img class="portrait" src="../../../images/profile/abc@i2sec.co.kr.png" />
    <h1 class="post-title">IoT 근거리 통신 Z-wave 해킹-1</h1>
    <span class="post-date">2017년 04월 05일</span>
    <span class="sep">|</span>
    <span class="author-name"><a href="mailto:abc@i2sec.co.kr">문경곤</a></span>
  
</div>



  <div class="post"><p>안녕하세요.<br />
이번 글 에서 다룰 내용은 최근 가하급수적으로 증폭하고 있는 IoT 디바이스가 통신할 때 사용하는 통신 프로토콜에 대해서 살펴 보겠습니다.<br />
<br />
IoT 해킹 주제를 다루게 된 계기로는, i2sec 최근 국내 S모기업 IoT 모의해킹 프로젝트를 수행하게 되었고, 요즘 4차산업혁명의 주역이자 매우 Hot한 아이템이기 때문입니다.<br />
그럼 한번 빠져 봅시다.<br /><br /></p>

<p>IoT 시스템 구성은 일반적으로 아래와 같습니다.
<img src="/images/2017-04-05/iotarch.jpg" alt="IoTsystem" />
<br />
IoT 서비스를 제공해 주는 서비스 서버, 관리서버와 가스락, 도어락, 플러그, 스위치 등의 IoT 단말들<br />
그리고, 서버와 단말의 네트워크 통신에 도움을 주는 IoT 허브와 AP로 구성되어 있습니다.<br />
<br />
저희는 오늘 IoT 허브와 IoT 단말간 근거리 통신에 자주 사용되는 Z-Wave 취약점에 대해 살펴 보겠습니다.<br />
<img src="/images/2017-04-05/iot2.png" alt="IoTThings" />
<br />
Z-Wave 취약점 발생구간은 위 그림과 같이단말기에 직접 통신하는 구간에서 발생하며, 취약점으로는 스니핑, 인증 키 우회, 패킷 Replay Attack 등이 있습니다.<br />
<br />
Z-Wave 자주 쓰이냐구요? 겁나 많은 IoT 디바이스들이 근거리 통신에 사용 중 입니다.
<br />
그럼 Z-Wave에 대해서 조금 살펴보죠.
<br />
<strong>Z-Wave</strong>는 <a href="https://ko.wikipedia.org/wiki/%EB%8D%B4%EB%A7%88%ED%81%AC">덴마크</a>회사인 <a href="http://z-wave.sigmadesigns.com/">Zensys</a>와 <a href="http://www.z-wavealliance.com/">Z-Wave 얼라이언스</a>에서 개발한 상호운용성을 가지는 무선 <a href="https://ko.wikipedia.org/wiki/통신_프로토콜">통신 프로토콜</a>로 가정 자동화와 센서 네트워크와 같은 저전력과 저 대역폭을 요구하는 장치를 위해 설계되었습니다.<br />
<a href="http://www.z-wavealliance.com/">Z-Wave 얼라이언스</a>는 Z-Wave 표준에 기반한 무선 홈컨트롤 제품들을 구축하는 것에 동의하는 <a href="http://z-wavealliance.org/z-wave_alliance_member_companies/">160개 이상의제조사</a>들로 이루어진 컨소시엄으로 2017년 현재 1700여개의 상호운용가능한 Z-Wave 제품들과 약 7000만개가 넘는 Z-Wave 장비들이 출시되어 있습니다.<a href="http://products.z-wavealliance.org/">참고</a><br /><br />
<img src="/images/2017-04-05/zwave1.png" alt="z-wave-1" />
<br />
Z-wave는 9,600bits/s, 40kbits/s 데이터 전송속도를 지원하며, 사용하는 주파수 대역은 860~920Mhz를 사용합니다.<br />
국가별로 통신 주파수 대역의 차이가 있는데, 한국의 경우 920.9MHz, 921.MHz, 923.1MHz를 사용합니다.<br /><br />
주파수 전이방식은 GFSK를 이용하며, 최대 232노드를 수용하며 30~100m 거리의 근거리 통신을 가능하게 해줍니다.<br />
<br /><br />
Z-wave의 Structure<br />
Controller, Node로 구성되어 있으며 제어를 하기 위해선 ID(고유 식별 정보), Home ID, Network ID, Node ID가 필요합니다.
<img src="/images/2017-04-05/zwave3.png" alt="z-wave-2" /><br />
Z-wave Stack<br />
<img src="/images/2017-04-05/zwave_stack.png" alt="z-wave-stack" /><br />
Z-wave은 총 4가지 Layer로 구성되어 있으며 디지털-&gt;아날로그 전환 해주는 Phy Layer, 충돌 회피, 저전력 운영과 관련된 MAC Layer, 전송의 신뢰성, 라우팅을 관리하는 Transport, Routing Layer,
전송방식, 명령제어를 해주는 Application Layer로 구성되어 있습니다.<br /><br /></p>

<p>Z-wave Pairing &amp; Command<br />
Pairing: Controller와 Slave 연결을 맺는 과정입니다. 아래 그림을 보시면 이해가 빠르실 거 같네요.<br />
<img src="/images/2017-04-05/z-wave pairing.png" alt="z-wave_pairing" /><br />
Command: Controller가 Slave에게 명령어를 전달하는 과정입니다.<br />
<img src="/images/2017-04-05/zwave_command.png" alt="zwave_command" /><br />
<br />
<br />
1편에서는 이렇게 Z-wave의 기본 원리에 대해서 살펴보았습니다.<br />
2편에서는 대망의 기본원리의 취약점을 이용한 공격 방안에 대해 리뷰하겠습니다.<br />.
SNS에 노출된 눈의 피로를 제 컨텐츠에 투자 해 주신 것을 감사드립니다.</p>
</div>


<div class="post-footer">
  <div class="back-btn"><a href="/">목록으로 돌아가기</a></div>
  <div class="fb-like" data-href="https://i2sec.github.io/2017/04/05/z_wave_exploit-1.html" data-layout="button_count" data-width="" data-share="false" data-show-faces="false"></div>
  <div class="fb-comments" data-href="https://i2sec.github.io/2017/04/05/z_wave_exploit-1.html" data-num-posts="5" data-width=""></div>
  <div id="fb-root"></div>
</div>
<script>
document.addEventListener("DOMContentLoaded", function(event) {
    $('.fb-like, .fb-comments').attr('data-width', "100%");
    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/ko_KR/all.js#xfbml=1&appId=207542736008055";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
});
</script>
<style>
.hiring-banner {
  height: 320px;
  background-position-y: 80%;
}
.hiring-subtitle
{
  display: none;
}
.btn-job{
  margin-top: 4px;
}
@media only screen and (max-width: 360px) {
  .hiring-banner {
    height: 220px;
  }
}
}
</style>

    </div>
    <div class="push">
    </div>
    <div class="footer">
      <div id="info">
        <span>© <a href="http://i2sec.co.kr/">i2sec</a> Inc. All rights reserved.</span>
        <span>Powered by <a href="https://pages.github.com/">GitHub Pages</a>.</span>
      </div>
    </div>
  </div>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
    $(function() {
      $('.hiring-banner').bind("click", function() {
        location.href = '/jobs.html';
      });
      $('.toggle').bind("touchstart", function() {
        $('.menu').toggle();
      })
    });
  </script>
  <!-- Responsive layout polyfill for IE8 and lower -->
  <!--[if lte IE 8]>
  <script>
    var config = {
        mobileResponsiveBreakpoint: 650
    };
    $(window).on('resize', function(){
        if ($(window).width() <= config.mobileResponsiveBreakpoint) {
           !$(document.body).hasClass('res-mobile')) {
            $(document.body).addClass('res-mobile');
        } else {
            $(document.body).removeClass('res-mobile');
        }
    }).trigger('resize');
  </script>
  <![endif]-->
</body>
</html>
